(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f16"],{"36a7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Pagination",{staticClass:"is-pulled-right",staticStyle:{"margin-right":"0"},attrs:{total:t.meta.total,page:t.meta.current_page,"page-size":t.meta.per_page,"last-page":t.meta.last_page},on:{"change-page":function(e){t.$emit("change-page",e)}}})},s=[],r={props:["meta"]},i=r,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null);l.options.__file="index.vue";e["a"]=l.exports},"727f":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{domProps:{innerHTML:t._s(t.highlight)}})},s=[],r=(a("a481"),{props:{text:{},query:{}},computed:{highlight:function(){var t=this.query,e=null===this.text?"":this.text+"";return""===t?e:"string"===typeof e?e.replace(t,'<strong class="has-background-warning">'.concat(t,"</strong>")):e}}}),i=r,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null);l.options.__file="index.vue";e["a"]=l.exports},"8c8c":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"control"},[a("div",{staticClass:"select"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.state,expression:"state"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.state=e.target.multiple?a:a[0]},function(e){t.$emit("change",t.state)}]}},[a("option",{domProps:{value:null}},[t._v("全部")]),a("option",{domProps:{value:0}},[t._v("待规划")]),a("option",{domProps:{value:1}},[t._v("规划中")]),a("option",{domProps:{value:2}},[t._v("已规划")])])])])},s=[],r={model:{prop:"value",event:"change"},props:{value:{}},data:function(){return{state:null}}},i=r,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null);l.options.__file="TaskStatusSelect.vue";e["a"]=l.exports},aeff:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-container is-flex is-flex-column",staticStyle:{padding:"0.5rem"}},[a("div",[a("div",{staticClass:"field has-addons"},[a("TaskStatusSelect",{model:{value:t.taskStatus,callback:function(e){t.taskStatus=e},expression:"taskStatus"}}),a("div",{staticClass:"control"},[a("input",{staticClass:"input",staticStyle:{width:"160px"},attrs:{type:"text"},domProps:{value:t.query},on:{change:t.handleQuery,keypress:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleQuery(e):null}}})]),a("div",{staticClass:"control"},[a("a",{staticClass:"button is-info",class:{"is-loading":t.loading},on:{click:t.search}},[a("Icon",{attrs:{name:"search"}})],1)])],1)]),a("div",{staticClass:"full-container is-flex-auto",staticStyle:{"margin-top":"0.5rem"}},[a("div",{staticClass:"table-container"},[t.loading?t._e():a("table",{staticClass:"table is-bordered is-nowrapped"},[a("thead",[a("th"),a("th",[t._v("位置代码")]),a("th",[t._v("零件号")]),a("th",[t._v("工位")]),a("th",[t._v("项目编号")]),a("th",[t._v("项目状态")]),a("th",[t._v("任务备注")]),a("th",[t._v("任务状态")]),t._l(t.columns,function(e){return"data_id"!==e.name?a("th",{key:e.id},[t._v("\n            "+t._s(e.text)+"\n          ")]):t._e()})],2),a("tbody",t._l(t.tasks,function(e){return a("tr",{key:e.id},[a("th"),a("DataId",{attrs:{query:t.query,task:e,taskArea:e.taskArea},on:{change:function(a){t.$wait(function(){return t.updateLocation({task:e,dataId:a})})}}}),a("td",[a("QueryHighlighter",{attrs:{text:e.part_id,query:t.query}})],1),a("td",[a("QueryHighlighter",{attrs:{text:e.line_id,query:t.query}})],1),a("td",[a("QueryHighlighter",{attrs:{text:e.project.name,query:t.query}})],1),a("ProjectStatusCell",{attrs:{value:e.project.filed_at}}),a("td",[a("QueryHighlighter",{attrs:{text:e.comment,query:t.query}})],1),a("TaskStatusCell",{attrs:{value:e.status}}),t._l(t.columns,function(n){return"data_id"!==n.name?a("td",{key:n.id},[t._v("\n              "+t._s(e.location[n.name])+"\n            ")]):t._e()})],2)}))])])]),a("div",{staticStyle:{"margin-top":"0.5rem"}},[a("Pagination",{attrs:{meta:t.meta},on:{"change-page":function(e){t.page=e,t.search()}}})],1)])},s=[],r=(a("386d"),a("ac6a"),a("96cf"),a("3040")),i=a("c93e"),u=(a("cadf"),a("551c"),a("097d"),a("2f62")),l=a("ea7f"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("EditableCell",{staticClass:"is-centered",class:{"has-text-danger":t.taskArea.data_id&&!t.task.location.id},attrs:{value:t.taskArea.data_id},on:{change:function(e){t.$emit("change",e)}}})},c=[],d=a("bf87"),h={name:"TaskAreaLocationId",components:{EditableCell:d["a"]},props:{task:Object,taskArea:Object}},p=h,f=a("2877"),v=Object(f["a"])(p,o,c,!1,null,null,null);v.options.__file="data-id.vue";var g=v.exports,m=a("b716"),_=a("d919"),k=a("8c8c"),y=a("36a7"),x=a("727f"),b={name:"TaskArea",components:{DataId:g,Pagination:y["a"],EditableCell:d["a"],TaskStatusCell:m["a"],ProjectStatusCell:_["a"],TaskStatusSelect:k["a"],QueryHighlighter:x["a"]},props:{plantId:{},areaId:{}},data:function(){return{list:[],data:{},meta:{},page:1,query:"",taskStatus:null,loading:!0,initialized:!1}},computed:Object(i["a"])({params:function(){return{page:this.page,query:this.query,areaId:this.areaId,taskStatus:this.taskStatus}}},Object(u["e"])({area:function(t){return t.areas.data[this.areaId]},columns:function(t){return this.area.columns.map(function(e){return t.columns.data[e]})},tasks:function(){var t=this;return this.list.map(function(e){return t.data[e]})}})),methods:{search:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,l["a"].searchArea(this.params);case 4:e=t.sent,this.data={},this.list=[],e.data.forEach(function(t){a.list.push(t.id),a.$set(a.data,t.id,t)}),this.meta=e;case 9:return t.prev=9,this.loading=!1,t.finish(9);case 12:case"end":return t.stop()}},t,this,[[1,,9,12]])}));return function(){return t.apply(this,arguments)}}(),updateLocation:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.task,n=e.dataId,t.next=3,l["a"].updateAreaLocation({taskId:a.id,areaId:this.areaId,dataId:n});case 3:s=t.sent,a.location=s,a.taskArea.data_id=n;case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleQuery:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.query=e.target.value.trim(),""!==this.query&&this.search();case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},watch:{areaId:{immediate:!0,handler:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.initialized=!1,t.next=3,this.search();case 3:this.initialized=!0;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}}},C=b,w=Object(f["a"])(C,n,s,!1,null,null,null);w.options.__file="index.vue";e["default"]=w.exports},b716:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{staticClass:"is-centered"},[a("span",{class:["tag","is-"+t.state.color]},[t._v("\n    "+t._s(t.state.text)+"\n  ")])])},s=[],r={props:{value:{}},data:function(){return{states:{0:{text:"待规划",color:"warning"},1:{text:"规划中",color:"info"},2:{text:"已完成",color:"success"}}}},computed:{state:function(){var t=this.states[this.value];return t||{color:"none",text:"其他"}}}},i=r,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null);l.options.__file="TaskStatusCell.vue";e["a"]=l.exports},bf87:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{ref:"td",class:{"is-editable":!0,"is-changed":t.isChanged||t.hasChanged,"is-outlined":t.isOutlined},attrs:{tabindex:"0"},domProps:{innerHTML:t._s(!t.isFocused&&t.value?t.matchedText:t.value)},on:{keypress:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleEsc(e):null},focus:t.handleFocus,blur:t.handleBlur}})},s=[],r=(a("a481"),{props:{value:{},highlight:String,isChanged:Boolean,isOutlined:Boolean},data:function(){return{inputValue:"",isFocused:!1,matchedText:"string"===typeof this.value?this.value.replace(this.highlight,'<strong class="has-background-warning">'.concat(this.highlight,"</strong>")):this.value}},computed:{hasChanged:function(){return""!==this.value&&null!==this.value&&this.value!==this.inputValue}},watch:{value:{immediate:!0,handler:function(){this.inputValue=this.value}}},methods:{handleFocus:function(t){this.isFocused=!0;var e=document.createRange(),a=window.getSelection();e.selectNodeContents(t.target),a.removeAllRanges(),a.addRange(e)},handleBlur:function(t){var e=document.createRange(),a=window.getSelection();e.selectNodeContents(t.target),a.removeAllRanges(),this.inputValue=t.target.innerText.trim(),i(this.value,this.inputValue)||this.$emit("change",this.inputValue)},handleEsc:function(t){t.target.blur()},focus:function(){this.$refs.td.focus()}}});function i(t,e){return null===t&&(t=""),null===e&&(e=""),t===e}var u=r,l=a("2877"),o=Object(l["a"])(u,n,s,!1,null,null,null);o.options.__file="index.vue";e["a"]=o.exports},d919:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{staticClass:"is-centered"},[a("span",{class:["tag","is-"+t.state.color]},[t._v("\n    "+t._s(t.state.text)+"\n  ")])])},s=[],r={props:{value:{}},data:function(){return{states:{true:{text:"进行中",color:"success"},false:{text:"已归档",color:"info"}}}},computed:{state:function(){var t=this.states[null===this.value];return t||{color:"none",text:"其他"}}}},i=r,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null);l.options.__file="ProjectStatusCell.vue";e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-2f16.9de13468.js.map